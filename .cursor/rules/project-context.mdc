---
description: RealSingles project context and codebase orientation
alwaysApply: true
---

# RealSingles Project Context

**What:** Dating app with dual platforms sharing a single backend.

| Platform | Stack | Status |
|----------|-------|--------|
| Mobile | Expo 54 (React Native 0.81) + React 19.1 | Live on App Store + Play Store |
| Web | Next.js 16.1 + React 19.2 + Tailwind 4.1 on Vercel | Marketing site + authenticated app |
| Backend | Supabase (PostgreSQL + Auth + Storage) | 100+ API endpoints |

---

## Codebase Structure

```
/mobile    → Expo app (iOS + Android)
/web       → Next.js app (API routes + Web UI + Admin/Matchmaker portals)
```

---

## Key Reference Files

### Mobile

| File | Purpose |
|------|---------|
| `mobile/app/(tabs)/_layout.tsx` | Native bottom tabs (best example of native-first) |
| `mobile/constants/options.ts` | Standardized dropdown options (shared across forms) |
| `mobile/components/forms/EditProfileForm.tsx` | Form patterns and field handling |
| `mobile/lib/api.ts` | API client (calls Next.js endpoints) |

### Web

| File | Purpose |
|------|---------|
| `web/src/app/api/users/me/route.ts` | User API route pattern |
| `web/src/app/(app)/layout.tsx` | Main authenticated app layout |
| `web/src/app/(app)/messages/page.tsx` | Messaging UI with real-time updates |
| `web/src/components/chat/ChatThread.tsx` | Chat component pattern |
| `web/src/hooks/useSupabaseMessaging.ts` | Real-time messaging hook |
| `web/src/components/ui/` | Shared UI components (ShadCN/Radix) |

---

## Major Features

### Core User Features
- **Matching system** — Discovery, likes, matches with real-time notifications
- **Messaging** — Real-time chat with typing indicators and read receipts
- **Video/Audio calls** — LiveKit-powered voice and video chat
- **Events** — Speed dating and community events
- **Profiles** — Photo galleries, bios, preferences

### Admin & Matchmaker Portals
- **Matchmaker portal** (`/matchmaker-portal`) — Client management, profile creation, match suggestions
- **Admin routes** — User management, content moderation, analytics

---

## API Structure

- All API routes live in `web/src/app/api/`
- Mobile calls these same endpoints via `mobile/lib/api.ts`
- **Key endpoint groups:**
  - `auth/` — Authentication and onboarding
  - `users/` — Profile management and preferences
  - `matches/` — Matching, likes, and compatibility
  - `conversations/` — Messaging and chat
  - `calls/` — Video/audio call setup and notifications
  - `matchmakers/` — Matchmaker operations and client management
  - `events/` — Speed dating and community events
  - `rewards/` — Points and referral system
  - `admin/` — Administrative operations

---

## Database Migrations

**Location:** `web/supabase/migrations/`

**Commands (run from `/web`):**
| Command | Use |
|---------|-----|
| `pnpm db:migrate` | Push migrations + regenerate types (interactive) |
| `pnpm db:types` | Regenerate TypeScript types only |
| `pnpm db:status` | Check migration sync status |

**Rules:**
1. **Always make migrations idempotent** — use `DROP ... IF EXISTS` before `CREATE`, use `IF NOT EXISTS` for tables/columns
2. **Always regenerate types after schema changes** — run `pnpm db:types` or use `pnpm db:migrate`
3. **Never reuse migration numbers** — each migration needs a unique numeric prefix

---

## Related Rules

- **cross-platform-parity** — SSOT and functionality requirements
- **platform-native-guidelines** — Native UI patterns per platform
- **real-singles-basics** — Project overview and philosophy
